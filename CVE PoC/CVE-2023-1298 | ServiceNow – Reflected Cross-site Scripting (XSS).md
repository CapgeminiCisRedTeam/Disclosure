# **CVE-2023-1298 - ServiceNow – Reflected Cross-site Scripting (XSS)**

### Description
It was found a Cross-site scripting (XSS) vulnerability which allows an attacker to execute arbitrary Javascript code via a crafted payload injected into the URI path.


### Affected Product Code Base
* San Diego prior to San Diego Patch 10
* Tokyo prior to Tokyo Patch 4b and Patch 6
* Utah Patch 1

### Fixed versions
* San Diego Patch 10
* Tokyo Patch 4b and Patch 6
* Utah Patch 2 and Patch 1 Hotfix 1a
* (Utah Patch 1 Hotfix 1a has been retired and replaced with Utah Patch 1 Hotfix 1b)

### Attack Vectors
An authenticated user can inject arbitrary scripts

### Discovered by
Osama Yousef

### Additional Contributors
Giovanni Colonna, Emanuele Cappello


#
#


## **Proof-of-Concept (POC)**

By Navigating the target website, I’ve noticed that any string in the URI path after `/now/nav/ui/classic/params/target/` is inserted in the `src` attribute of an `iframe`.

![1](https://github.com/CapgeminiCisRedTeam/Disclosure/assets/132057950/3d015f46-3914-4d0b-929b-bfad0aa2d1b1)

So the attacker could craft a malicious Javascript code within the URI path and send a malicious website to the victim.
When the victim tries to open the malicious link with the crafted payload, the attacker could execute a malicious Javascript code.

![2](https://github.com/CapgeminiCisRedTeam/Disclosure/assets/132057950/8c3cd46c-5b20-4a9c-8f62-d3d8d95db7b4)

![3](https://github.com/CapgeminiCisRedTeam/Disclosure/assets/132057950/b0c7bd1b-a007-4d0b-83d6-4c798de38b9c)

### ServiceNow Security Advisory
https://support.servicenow.com/kb?id=kb_article_view&sysparm_article=KB1310230 

https://www.cve.org/cverecord?id=CVE-2023-1298

https://nvd.nist.gov/vuln/detail/CVE-2023-1298

