# CVE-2023-39559 | AudimexEE v.15.0 - Full Path Disclosure

During a penetration test activity, we found several **Full Path Disclosure** on the **AudimexEE v.15.0** product.

### Overview
[AudimexEE](https://www.web-audimex.com/audimexee) is an audit software solution for large enterprises that fulfils highest demands in terms of the implementation of auditing processes and corporate structures surrounding a powerful and highly flexible audit universe.

## Proof of Concept

|  |  |
|-----------|-----------|
|**Vulnerability title**|**Full Path Disclosure**|
|**Vulnerability Description**|The web application leaks technical details about the website and its infrastructure.|
|**Vulnerability severity**|Medium|
|**CVSSv3.1 Vector String**|AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N|
|**CVSSv3.1 score**|4\.3|
|**OWASP Category**|A5|

### PoC#1
|  |  |
|-----------|-----------|
|**Vulnerable URL**|https://[AUDIMEX-HOST]/audimex/cgi-bin/wal.fcgi|
|**Vulnerable parameter**|Payload|
|**HTTP Method**|GET|
|**Authentication Required**|Yes|

After authenticating on the AudimexEE v.15 portal with a “normal user”,

![image](https://github.com/CapgeminiCisRedTeam/AudimexCVE/assets/132057950/ad642cf9-14f6-491a-b12d-d5824f3fcb19)

As can be seen in the following pictures, it is sufficient to send the application into error by inserting a non-existent file (replacing all the .pl files) and the complete handler path is shown.

![image](https://github.com/CapgeminiCisRedTeam/AudimexCVE/assets/132057950/8bb10f00-2c0c-48ae-949f-0c2359512a53)

### PoC#1
|  |  |
|-----------|-----------|
|**Vulnerable URL**|https://[AUDIMEX-HOST]/audimex/cgi-bin/wal.fcgi|
|**Vulnerable parameter**|stateFilter|
|**HTTP Method**|GET|
|**Authentication Required**|Yes|

In a similar way to the previous vulnerability, by inserting a single quote inside the stateFilter parameter it can be possible to trigger an error containing a File System’s Full path:

![image](https://github.com/CapgeminiCisRedTeam/AudimexCVE/assets/132057950/4bd739ed-7d5f-4091-b28b-ee12d3f1ebc0)

## Suggested Remediation
Handle the returned error message correctly so as not to expose the full path to the file.

## Discovered by

[Mirco Cassaro](https://www.linkedin.com/in/mirco-cassaro-0ab012a4)

[Paolo Caminati](https://www.linkedin.com/in/paolo-caminati-0b31751b2)
